@page "/Search"
@rendermode InteractiveServer
@inject RedisService RedisService
@using NRedisStack.Search

<h3>Product Search</h3>

<input @bind="SearchQuery" @bind:event="oninput" placeholder="Search products..." />
<button @onclick="PerformSearch">Search</button>

@if (SearchResults.Count > 0)
{
    <ul>
        @foreach (var result in SearchResults)
        {
            <li>@result</li>
        }
    </ul>
}

@code {
    private string SearchQuery { get; set; } = "";
    private List<string> SearchResults { get; set; } = new();

    private void PerformSearch()
    {
        var ft = RedisService.GetSearch();
        var results = ft.Search("idx_products", new Query("sam*").Limit(0, 10));
        SearchResults = results.Documents.Select(d => d["Description"].ToString()).ToList();
    }
}
